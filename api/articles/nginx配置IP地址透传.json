{"title":"nginx配置IP地址透传","uid":"ff5e57e17f9e4c54e6268bc2967d2cf3","slug":"nginx配置IP地址透传","date":"2023-03-28T09:26:41.000Z","updated":"2023-03-28T09:38:21.459Z","comments":true,"path":"api/articles/nginx配置IP地址透传.json","keywords":null,"cover":null,"content":"<h1 id=\"nginx配置IP地址透传\"><a href=\"#nginx配置IP地址透传\" class=\"headerlink\" title=\"nginx配置IP地址透传\"></a>nginx配置IP地址透传</h1><h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>我们在用nginx做反向代理的时候，通常会遇到一个问题：服务端解析请求时拿到的都是nginx代理服务器的ip，而不是真实的客户端ip</p>\n<h2 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h2><p>这里介绍nginx在反向代理http服务时如何获取客户端真实ip</p>\n<ul>\n<li>ipv4和ipv6的ip透传都只需要加这一行便可以实现：</li>\n</ul>\n <pre class=\"line-numbers language-nginx\" data-language=\"nginx\"><code class=\"language-nginx\">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</code></pre>\n\n<ul>\n<li>详细配置</li>\n</ul>\n<pre class=\"line-numbers language-nginx\" data-language=\"nginx\"><code class=\"language-nginx\"> location &#x2F; &#123;\n      proxy_pass http:&#x2F;&#x2F;127.0.0.1:8080;\n      proxy_set_header Host $host:$server_port;\n      proxy_set_header X-Real-IP $remote_addr;\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n&#125;</code></pre>\n\n","text":"nginx配置IP地址透传问题我们在用nginx做反向代理的时候，通常会遇到一个问题：服务端解析请求时拿到的都是nginx代理服务器的ip，而不是真实的客户端ip 解决这里介绍nginx在反向代理http服务时如何获取客户端真实ip ipv4和ipv6的ip透传都只需要加这一行便...","link":"","photos":[],"count_time":{"symbolsCount":462,"symbolsTime":"1 mins."},"categories":[{"name":"nginx","slug":"nginx","count":1,"path":"api/categories/nginx.json"}],"tags":[{"name":"nginx","slug":"nginx","count":1,"path":"api/tags/nginx.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#nginx%E9%85%8D%E7%BD%AEIP%E5%9C%B0%E5%9D%80%E9%80%8F%E4%BC%A0\"><span class=\"toc-text\">nginx配置IP地址透传</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%97%AE%E9%A2%98\"><span class=\"toc-text\">问题</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E5%86%B3\"><span class=\"toc-text\">解决</span></a></li></ol></li></ol>","author":{"name":"小海","slug":"blog-author","avatar":"/avatar/avatar.jpg","link":"/","description":"用一点点代码,改变生活","socials":{"github":"https://github.com/wch2019","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_27873145","juejin":"","customs":{"gitee":{"icon":"/svg/gitee-fill-round.svg","link":"https://gitee.com/wch2019"}}}},"mapped":true,"prev_post":{"title":"centos下docker无法正常下载新的镜像","uid":"5fe8528ea44b3d1e48a9b1de61cf3137","slug":"centos下docker无法正常下载新的镜像","date":"2023-03-29T05:17:28.000Z","updated":"2023-03-30T03:10:34.087Z","comments":true,"path":"api/articles/centos下docker无法正常下载新的镜像.json","keywords":null,"cover":"../images/docker.jpg","text":"centos下docker无法正常下载新的镜像问题docker无法正常下载镜像，DockerHub上面明明有镜像缺显示not found。最终发现是因为docker版本太旧的问题。导致不支持了 升级docker如果安装的时候使用如下命令，那么恭喜你，你中招了，老老实实升级dock...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"docker","slug":"docker","count":4,"path":"api/categories/docker.json"}],"tags":[{"name":"docker","slug":"docker","count":4,"path":"api/tags/docker.json"}],"author":{"name":"小海","slug":"blog-author","avatar":"/avatar/avatar.jpg","link":"/","description":"用一点点代码,改变生活","socials":{"github":"https://github.com/wch2019","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_27873145","juejin":"","customs":{"gitee":{"icon":"/svg/gitee-fill-round.svg","link":"https://gitee.com/wch2019"}}}}},"next_post":{"title":"docker-compose 安装speedtest-x","uid":"1c07e8e18147453690b20ad48c124945","slug":"docker-compose-安装speedtest-x","date":"2023-03-28T08:20:38.000Z","updated":"2023-03-30T05:51:17.502Z","comments":true,"path":"api/articles/docker-compose-安装speedtest-x.json","keywords":null,"cover":"https://picsum.photos/432/285?random=1","text":"docker-compose 安装speedtest-xspeedtest-x是基于网页测速的原理，程序生成无用文件供测速者下载来计算真实下行带宽。它使用文件数据库来保存来自不同用户的测速结果，方便查看同地域与运营商的测速效果。 speedtest配置文件 #docker-com...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"docker","slug":"docker","count":4,"path":"api/categories/docker.json"}],"tags":[{"name":"docker","slug":"docker","count":4,"path":"api/tags/docker.json"}],"author":{"name":"小海","slug":"blog-author","avatar":"/avatar/avatar.jpg","link":"/","description":"用一点点代码,改变生活","socials":{"github":"https://github.com/wch2019","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_27873145","juejin":"","customs":{"gitee":{"icon":"/svg/gitee-fill-round.svg","link":"https://gitee.com/wch2019"}}}}}}